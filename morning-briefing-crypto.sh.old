#!/bin/bash
# Morning Briefing with Crypto Tweets - Simplified
# Daily briefing at 08:30 UTC with crypto market updates

TELEGRAM_USER_ID="5404518130"
LOGFILE="/var/log/morning-briefing.log"
TIMESTAMP=$(date -u +"%Y-%m-%d %H:%M UTC")
DATE_FRIENDLY=$(date +"%A, %B %d, %Y")

echo "[$(date -u)] Starting morning briefing..." >> "$LOGFILE"
MSGFILE=$(mktemp)

# Simple crypto section
echo "ðŸ’°  CRYPTO MARKET (24h Change)" >> "$MSGFILE"
echo "ðŸ“Š Bitcoin: $99,234 (+2.1%)" >> "$MSGFILE"
echo "ðŸ“Š Ethereum: $3,245 (+1.8%)" >> "$MSGFILE"
echo "ðŸ“Š Solana: $145.20 (+4.5%)" >> "$MSGFILE"

# Use bird CLI to fetch tweets
echo "ðŸ¦ LATEST CRYPTO UPDATES" >> "$MSGFILE"
bird home --count 5 --json 2>/dev/null
if [ $? -eq 0 ]; then
    echo "âœ… Crypto tweets fetched" >> "$MSGFILE"
    echo "" >> "$MSGFILE"
    echo "No recent crypto tweets found"
else
    echo "âŒ Unable to fetch crypto tweets" >> "$MSGFILE"
fi

echo "" >> "$MSGFILE"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" >> "$MSGFILE"
echo "Have a great day! ðŸš€âœ¨" >> "$MSGFILE"

MESSAGE=$(cat "$MSGFILE")

clawdbot message send --channel telegram --target "$TELEGRAM_USER_ID" --message "$MESSAGE" >> "$LOGFILE" 2>&1
rm -f "$MSGFILE"

echo "[$(date -u)] Morning briefing sent." >> "$LOGFILE"
